import{d as B,e as q,_ as b,o as p,v as F,h as f,b as i,g as n,f as m,x as P,y as C,D as u,z as U,N as O,R,r as $,an as j,l as E,ao as T,ap as M,I as G,aq as A}from"./index-2e5f8ac5.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{S as H}from"./index-ca3234ae.js";import{n as J}from"./NavBar-14a98759.js";import{g as K,a as k}from"./good-37f6537b.js";/* empty css              */import{a as V}from"./function-call-875e4379.js";import"./cart-98dc10ac.js";import"./axios-772a9739.js";const Q=B({components:{},props:{productList:Object,productList1:Object},setup(){const d=q();return{productDetail:e=>{d.push({path:`/productDetail/${e.goods_id}`})}}}}),W={class:"product-wrapper"},X=["onClick"],Y={class:"item-info"},Z={class:"goods-name van-multi-ellipsis--l2"},tt={class:"prize-amount"},ot={class:"prize"},et={class:"amount"},at={class:"product-wrapper"},st=["onClick"],nt={class:"item-info"},ct={class:"goods-name van-multi-ellipsis--l2"},it={class:"prize-amount"},rt={class:"prize"},dt={class:"amount"};function lt(d,t,e,_,v,S){const g=U,l=O,L=R;return p(),F(L,null,{default:f(()=>[i(l,{span:"12"},{default:f(()=>[n("div",W,[(p(!0),m(P,null,C(d.productList,s=>(p(),m("div",{class:"product-item",key:s.goods_id,onClick:y=>d.productDetail(s)},[i(g,{width:"100%",fit:"cover",position:"center",src:s.goods_big_logo},null,8,["src"]),n("div",Y,[n("div",Z,u(s.goods_name),1),n("div",tt,[n("span",ot,"￥ "+u(s.goods_price),1),n("span",et," x"+u(s.goods_number),1)])])],8,X))),128))])]),_:1}),i(l,{span:"12"},{default:f(()=>[n("div",at,[(p(!0),m(P,null,C(d.productList1,s=>(p(),m("div",{class:"product-item",key:s.goods_id,onClick:y=>d.productDetail(s)},[i(g,{width:"100%",fit:"cover",position:"center",src:s.goods_big_logo},null,8,["src"]),n("div",nt,[n("div",ct,u(s.goods_name),1),n("div",it,[n("span",rt,"￥ "+u(s.goods_price),1),n("span",dt," x"+u(s.goods_number),1)])])],8,st))),128))])]),_:1})]),_:1})}const ut=b(Q,[["render",lt],["__scopeId","data-v-ff7f15a6"]]);const pt={class:"search-header"},_t={class:"product-list"},mt={__name:"ProductList",setup(d){const t=$({productList:[],productList1:[],loading:!1,finished:!1,totalPage:1,cascaderShow:!1,fieldValue:"",cascaderValue:"",cascaderOptions:[]}),e=$({query:"",pagenum:1,pagesize:10}),_=j(),v=q(),S=async()=>{if(_.query.cat_name!==void 0){const{cat_id:a,cat_name:o}=_.query;e.cat_name=o,e.cat_three_id=Number(a),t.fieldValue=`${e.cat_name}   （点击选择产品类别）`}l(),g()},g=async()=>{const a={type:3,pagenum:1,pagesize:30},{data:o}=await K({params:a});if(o.meta.status===200)t.cascaderOptions=o.data;else return V("获取类别列表失败")},l=async()=>{const{data:a}=await k(e);if(t.finished=!1,a.meta.status===200){const o=[],r=[];a.data.goods.forEach((h,w)=>{w%2===0?o.push(h):r.push(h)}),t.productList=o,t.productList1=r,t.totalPage=Math.ceil(a.data.total/e.pagesize),t.loading=!1,t.totalPage>=a.data.totalPage&&(t.finished=!0)}else return V("获取失败")};S();const L=({selectedOptions:a})=>{e.query="",e.pagenum=1,t.cascaderShow=!1,t.fieldValue=a.map(r=>r.cat_name).join("/"),e.cat_name=a[2].cat_name,e.cat_three_id=a[2].cat_id,l();const o=document.querySelector(".product-list");o.scrollTop=0},s=async()=>{const a=document.querySelector(".product-list");a.scrollTop=0,v.push({query:{}}),e.cat_name=null,e.cat_three_id=null,t.fieldValue="",t.cascaderValue="",e.pagenum=1,l()},y=async()=>{if(_.query.cat_name!==void 0){const{cat_id:o,cat_name:r}=_.query;e.cat_name=r,e.cat_three_id=Number(o)}const{data:a}=await k(e);if(a.meta.status!==200)return V("获取失败");t.totalPage=Math.ceil(a.data.total/e.pagesize),a.data.goods.forEach((o,r)=>{r%2===0?t.productList.push(o):t.productList1.push(o)}),t.loading=!1,e.pagenum>=a.data.totalPage&&(t.finished=!0)},x=()=>{if(console.log("滚动开始"),console.log(e.pagenum),console.log(t.totalPage),e.pagenum>=t.totalPage){t.finished=!0;return}e.pagenum<t.totalPage&&(e.pagenum=e.pagenum+1),y()},z=()=>{v.go(-1)};return(a,o)=>{const r=G,h=H,w=E,D=A,I=T,N=M;return p(),m(P,null,[n("div",pt,[n("div",{class:"return",onClick:z},[i(r,{name:"arrow-left",size:"20"})]),i(h,{modelValue:e.query,"onUpdate:modelValue":o[0]||(o[0]=c=>e.query=c),shape:"round",placeholder:"请输入搜索关键词",onSearch:s},null,8,["modelValue"])]),i(w,{modelValue:t.fieldValue,"onUpdate:modelValue":o[1]||(o[1]=c=>t.fieldValue=c),"is-link":"",readonly:"",label:"产品类别",placeholder:"Select Product Categories",onClick:o[2]||(o[2]=c=>t.cascaderShow=!0)},null,8,["modelValue"]),i(I,{show:t.cascaderShow,"onUpdate:show":o[5]||(o[5]=c=>t.cascaderShow=c),round:"",position:"bottom"},{default:f(()=>[i(D,{modelValue:t.cascaderValue,"onUpdate:modelValue":o[3]||(o[3]=c=>t.cascaderValue=c),title:"Select Product Categories","field-names":{text:"cat_name",value:"cat_id",children:"children"},options:t.cascaderOptions,onClose:o[4]||(o[4]=c=>t.cascaderShow=!1),onFinish:L},null,8,["modelValue","options"])]),_:1},8,["show"]),n("div",_t,[i(N,{loading:t.loading,"onUpdate:loading":o[6]||(o[6]=c=>t.loading=c),finished:t.finished,"finished-text":t.productList.length?"No more":"Search for the product you want",onLoad:x,onOffset:c=>0},{default:f(()=>[i(ut,{productList1:t.productList1,productList:t.productList},null,8,["productList1","productList"])]),_:1},8,["loading","finished","finished-text"])]),i(J)],64)}}},qt=b(mt,[["__scopeId","data-v-17ff6452"]]);export{qt as default};
